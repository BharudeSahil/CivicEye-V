<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Crime Rate Analysis by City</title>
  <script src="https://d3js.org/d3.v7.min.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background-color: #f9f9f9;
      color: #333;
    }
    h1 {
      text-align: center;
      margin-bottom: 20px;
    }
    .dropdown {
      margin-bottom: 30px;
      text-align: center;
    }
    .dropdown label {
      font-weight: bold;
      margin-right: 10px;
    }
    .dropdown select {
      padding: 8px;
      font-size: 14px;
      border-radius: 5px;
      border: 1px solid #ccc;
      background-color: #fff;
    }
    .chart-container {
      margin-bottom: 50px;
      padding: 20px;
      background: #fff;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      border-radius: 8px;
    }
    .chart-title {
      font-size: 18px;
      font-weight: bold;
      margin-bottom: 15px;
      text-align: center;
    }
    .chart-description {
      font-size: 14px;
      margin-bottom: 20px;
      color: #555;
    }
    .bar {
      opacity: 0.8;
    }
    .bar:hover {
      opacity: 1;
    }
    .axis-label {
      font-size: 12px;
    }
    .legend rect {
      stroke-width: 1;
    }
    .line {
      stroke: #ccc;
      stroke-width: 0.5;
    }
    svg {
      font-size: 12px;
    }
  </style>
</head>
<body>
  <h1>Crime Rate Analysis by City</h1>
  <div class="dropdown">
    <label for="city-select">Select City:</label>
    <select id="city-select">
      <option value="Agra">Agra</option>
      <option value="Delhi">Delhi</option>
      <option value="Mumbai">Mumbai</option>
      <!-- Add more cities here -->
    </select>
  </div>
  <div id="charts-container"></div>

  <script>
    const cityData = {
      Agra: {
        violentCrimes: {
          "attempt to commit murder": 4.6,
          "culpable homicide not amounting to murder": 2,
          "kidnapped & abduction": 9.8,
          "murder": 4.4,
          "riots": 12.9,
        },
        crimesAgainstWomen: {
          "cruelty by husband or his relatives": 7,
          "dowry deaths": 2,
          "rape": 4.5,
          "sexual harassment and molestation of women": 6.2,
        },
        propertyCrimes: {
          "arson": 3,
          "auto theft": 6,
          "burglary": 7.5,
          "dacoity": 4,
          "other theft": 8,
          "robbery": 5,
        },
        economicCrimes: {
          "cheating": 6,
          "counterfeiting": 2.5,
          "criminal breach of trust": 4,
          "forgery": 3.5,
        },
      },
      Delhi: {
        violentCrimes: {
          "attempt to commit murder": 5.2,
          "culpable homicide not amounting to murder": 1.8,
          "kidnapped & abduction": 10.5,
          "murder": 5.0,
          "riots": 14.2,
        },
        crimesAgainstWomen: {
          "cruelty by husband or his relatives": 8,
          "dowry deaths": 2.2,
          "rape": 5.0,
          "sexual harassment and molestation of women": 7.0,
        },
        propertyCrimes: {
          "arson": 3.5,
          "auto theft": 7.0,
          "burglary": 8.0,
          "dacoity": 4.5,
          "other theft": 9.0,
          "robbery": 5.5,
        },
        economicCrimes: {
          "cheating": 6.5,
          "counterfeiting": 3.0,
          "criminal breach of trust": 4.5,
          "forgery": 4.0,
        },
      },
      Mumbai: {
        violentCrimes: {
          "attempt to commit murder": 4.8,
          "culpable homicide not amounting to murder": 1.5,
          "kidnapped & abduction": 8.5,
          "murder": 4.0,
          "riots": 11.5,
        },
        crimesAgainstWomen: {
          "cruelty by husband or his relatives": 6.5,
          "dowry deaths": 1.8,
          "rape": 4.0,
          "sexual harassment and molestation of women": 5.5,
        },
        propertyCrimes: {
          "arson": 2.8,
          "auto theft": 5.5,
          "burglary": 7.0,
          "dacoity": 3.8,
          "other theft": 7.5,
          "robbery": 4.5,
        },
        economicCrimes: {
          "cheating": 5.8,
          "counterfeiting": 2.2,
          "criminal breach of trust": 3.8,
          "forgery": 3.2,
        },
      },
    };

    const nationalAverage = {
      violentCrimes: {
        "attempt to commit murder": 5.0,
        "culpable homicide not amounting to murder": 1.8,
        "kidnapped & abduction": 9.0,
        "murder": 4.8,
        "riots": 12.0,
      },
      crimesAgainstWomen: {
        "cruelty by husband or his relatives": 7.5,
        "dowry deaths": 2.0,
        "rape": 4.8,
        "sexual harassment and molestation of women": 6.5,
      },
      propertyCrimes: {
        "arson": 3.2,
        "auto theft": 6.5,
        "burglary": 7.8,
        "dacoity": 4.2,
        "other theft": 8.5,
        "robbery": 5.2,
      },
      economicCrimes: {
        "cheating": 6.2,
        "counterfeiting": 2.8,
        "criminal breach of trust": 4.2,
        "forgery": 3.8,
      },
    };

    const margin = { top: 50, right: 20, bottom: 70, left: 50 };
    const width = 800 - margin.left - margin.right;
    const height = 400 - margin.top - margin.bottom;

    function createChart(container, title, data, subCategories, colors, nationalData) {
      const svg = d3
        .select(container)
        .append("svg")
        .attr("width", width + margin.left + margin.right)
        .attr("height", height + margin.top + margin.bottom)
        .append("g")
        .attr("transform", `translate(${margin.left},${margin.top})`);

      const x0 = d3.scaleBand().domain(subCategories).range([0, width]).padding(0.2);
      const y = d3.scaleLinear().domain([0, d3.max([...Object.values(data), ...Object.values(nationalData)])]).nice().range([height, 0]);

      svg.append("g")
        .attr("transform", `translate(0,${height})`)
        .call(d3.axisBottom(x0).tickSize(-height).tickFormat(d => d));

      svg.append("g")
        .call(d3.axisLeft(y).ticks(5).tickSize(-width));

      svg.append("text")
        .attr("x", width / 2)
        .attr("y", -10)
        .attr("text-anchor", "middle")
        .style("font-size", "16px")
        .style("font-weight", "bold")
        .text(title);

      svg.selectAll(".bar-city")
        .data(subCategories)
        .enter()
        .append("rect")
        .attr("class", "bar bar-city")
        .attr("x", d => x0(d))
        .attr("y", d => y(data[d]))
        .attr("width", x0.bandwidth() / 2)
        .attr("height", d => height - y(data[d]))
        .attr("fill", d => colors[d]);

      svg.selectAll(".bar-national")
        .data(subCategories)
        .enter()
        .append("rect")
        .attr("class", "bar bar-national")
        .attr("x", d => x0(d) + x0.bandwidth() / 2)
        .attr("y", d => y(nationalData[d]))
        .attr("width", x0.bandwidth() / 2)
        .attr("height", d => height - y(nationalData[d]))
        .attr("fill", d => colors[d])
        .attr("opacity", 0.6);

      const legend = svg
        .selectAll(".legend")
        .data(subCategories)
        .enter()
        .append("g")
        .attr("class", "legend")
        .attr("transform", (d, i) => `translate(${i * 120},${height + 40})`);

      legend
        .append("rect")
        .attr("x", 0)
        .attr("y", 0)
        .attr("width", 18)
        .attr("height", 18)
        .attr("fill", d => colors[d]);

      legend
        .append("text")
        .attr("x", 25)
        .attr("y", 14)
        .text(d => d.toUpperCase())
        .attr("class", "axis-label");
    }

    function updateCharts(city) {
      const container = d3.select("#charts-container");
      container.html("");

      const categories = {
        violentCrimes: "Violent Crimes refer to crimes involving force or threat of force.",
        crimesAgainstWomen: "Crimes Against Women include cruelty, dowry deaths, rape, and harassment.",
        propertyCrimes: "Property Crimes involve arson, auto theft, burglary, and robbery.",
        economicCrimes: "Economic Crimes consist of cheating, counterfeiting, and forgery.",
      };

      Object.keys(cityData[city]).forEach(crimeType => {
        const data = cityData[city][crimeType];
        const nationalData = nationalAverage[crimeType];
        const subCategories = Object.keys(data);

        createChart(
          container.node(),
          crimeType.replace(/([A-Z])/g, ' $1').toUpperCase(),
          data,
          subCategories,
          { "attempt to commit murder": "#89CFF0", "culpable homicide not amounting to murder": "#A9A9A9", "kidnapped & abduction": "#90EE90", "murder": "#FFA07A", "riots": "#B19CD9", "cruelty by husband or his relatives": "#F08080", "dowry deaths": "#FFDAB9", "rape": "#FFB6C1", "sexual harassment and molestation of women": "#E6E6FA", "arson": "#FFD700", "auto theft": "#DAA520", "burglary": "#FF7F50", "dacoity": "#87CEEB", "other theft": "#40E0D0", "robbery": "#FF4500", "cheating": "#00FA9A", "counterfeiting": "#98FB98", "criminal breach of trust": "#32CD32", "forgery": "#1E90FF" },
          nationalData
        );
      });
    }

    d3.select("#city-select").on("change", function () {
      updateCharts(this.value);
    });

    updateCharts("Agra"); // Default city
  </script>
</body>
</html>